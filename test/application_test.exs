defmodule StickerClient.RuntimeTest.ApplicationTest do
  use ExUnit.Case, async: true

  test "can load signal CA certificates" do
    certs = :public_key.cacerts_get()
    assert Enum.count(certs) === 1
    {:cert, b, _c} = certs |> hd()

    # Travering the OTP Certificate was a pain so I instead just took the binary for the public key and hex encoded it
    assert b |> Base.encode16() ==
             "308205DB308203C3A003020102021400C1F3E20EB47080C1A4FAF583267F24369A3E97300D06092A864886F70D01010B05003075310B3009060355040613025553311330110603550408130A43616C69666F726E6961311630140603550407130D4D6F756E7461696E2056696577311E301C060355040A13155369676E616C204D657373656E6765722C204C4C4331193017060355040313105369676E616C204D657373656E676572301E170D3232303132363030343535315A170D3332303132343030343535305A3075310B3009060355040613025553311330110603550408130A43616C69666F726E6961311630140603550407130D4D6F756E7461696E2056696577311E301C060355040A13155369676E616C204D657373656E6765722C204C4C4331193017060355040313105369676E616C204D657373656E67657230820222300D06092A864886F70D01010105000382020F003082020A0282020100C479C89FC4C1C79438716C4455744ACE846B0B3B4F0F51D3640138D9D644F9D6E3DFE493E245BBACF45E09FC680143800D4808C80D9B8563458EBC6FE2D2ABF1B61A56EF4A1CA7C22392259336203CD7340D41D0A259B183538075B0B8B6A3826024CC1E4A44058B20F29EA5A01E9C3E2A6BF2B42CD15A7BEBAE9B487C4E063F134EB00B5715B547FBEF093B8D8868A45595B7E97BF9541DB8E262622942BA193C63D8E0EAA5F0A337A37F4E6CF9D3A355A83389A8C8E399A54DE55756B07EDBD6071D6C6D304BD36B1059F1D1C6035517E3E3D1F74330C15D149A1B02BACB55F2B651AF9D60DE295795C8C7355AAD2456EF7097A90FB6AA5A0F5BFCA7A5ADE046D61E1965788E5EDE0F43E6787A4A398EFC89D3F81F58DF02FD1301578AA6E079645676B337324B1AD06BC77B1487F490D25EF602118DB43E5EBBE737E659BE3E9DFBCB8126AF0B7D068586555F234FDA21D82049C6A947BC3CA0BA6F75F9545AA7132DE5D534B56B835E5C103C1D955F0F56C713FCA4F46DF373288F34A81ABC2F24666AE02A3F40838DAC9819BD9401A6E785E7E099163A681139997C5D6F2004CF3092DEF0F18DE4C3F2FF276C3ABE483EA5262D22EE383011F34385EF572B9D1B68AD7951D73C0ABFD996118C8CD996A817748C8A5A666D6BCD60349385705ED0F0A415D2CFCA0116C8625ECDC50FA8C7636221391DE9A5BC9DE2A454A70203010001A3633061300E0603551D0F0101FF040403020106300F0603551D130101FF040530030101FF301D0603551D0E04160414B5F34BC6E5D64BD0E5806B8C50C3675BBCB1F371301F0603551D23041830168014B5F34BC6E5D64BD0E5806B8C50C3675BBCB1F371300D06092A864886F70D01010B05000382020100151E8ABC92D2A8F290137BE5AA073BD6D53EBAD7F83489201F55D98CE4155CA1FE2A3AE5024C1BC9DA59518E4A9551C14C216552A1DC9569FE688F8334C6028EF386B0C8A1773E8A1EE8AC031BD7DAA897FD876BC3992DAEF92E88C93516D9A024790BE80CF02FACA4C2E315FF64DC957175A8E1B5151C474CD8870B014BBA99E4C7B477A8115C3D198926DA74C3314B0E8A7CA93778F98F6FD817F8C4534BADDCF262F355807FDDF7BF6E4A6AE11530CD41EFA197FE4940FB37349045040C7EF007971935D5354DC527183EDC570F28B2DC2B2C97D816AEB5AA43FA26B878A9A07EB627B87C28061BAFAA0422AF82CEE7A773778220118105FBC2A6E14E81C9005D713832505AB0453430EEBA1AB4C280CB7D6C0992C374EB44FD76F99505C5836DA9696E454F09590E050823DCCFDA6031104E827E254F10D91BE238ECE28DB924631443FDE1C760C5DDC7FF904AED61D4CF5B40190E0181EA525E09A3CE27C54F91554C34E5DD99D651505788762D6CE0602E248891BA863022EDAC1B4521E43B4514DBDCBF8813D474501D1C241DC05DB7F595590E726ADDBB687C037D9A0B0B6BE52D5F045D6E9E51BB8A63E6A897E938C59AF32205FCA5959B6F4900FABC2EBB326DBD33E6083CC3B65B944B81F73396F4CDE5EB40D7B893BA97B83E75E57A3FDEABBF6BA71D2F1496F5A25560F2F6A7E00098B3CB2DE4A8CE253B0047"
  end
end
